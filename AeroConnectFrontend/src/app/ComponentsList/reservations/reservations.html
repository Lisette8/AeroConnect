<main class="reservations-page">
    <!-- Success Toast Notification -->
    <div class="toast-notification" [class.show]="showToast">
      <div class="toast-content">
        <div class="toast-icon">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
            <polyline points="22 4 12 14.01 9 11.01"/>
          </svg>
        </div>
        <div class="toast-text">
          <h4>Merci pour votre réservation!</h4>
          <p>Votre vol a été réservé avec succès.</p>
        </div>
      </div>
      <div class="toast-progress"></div>
    </div>
  
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="hero-content">
        <span class="hero-badge">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
            <path d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"/>
          </svg>
          Réservation de vols
        </span>
        <h1>Trouvez votre<br/><span class="gradient-text">vol parfait</span></h1>
        <p>Parcourez nos destinations et réservez votre prochain voyage en quelques clics.</p>
      </div>
      <div class="hero-decoration">
        <div class="orbit-ring ring-1"></div>
        <div class="orbit-ring ring-2"></div>
        <div class="orbit-ring ring-3"></div>
        <div class="floating-plane">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
            <path d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"/>
          </svg>
        </div>
      </div>
    </section>
  
    <!-- Main Content -->
    <div class="main-content">
      
      <!-- Tab Navigation -->
      <div class="tab-navigation">
        <button class="tab-btn" [class.active]="activeTab === 'flights'" (click)="activeTab = 'flights'">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
            <path d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"/>
          </svg>
          Vols disponibles
        </button>
        <button class="tab-btn" [class.active]="activeTab === 'custom'" (click)="activeTab = 'custom'">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
          </svg>
          Réservation personnalisée
        </button>
      </div>
  
      <!-- TAB 1: Flights Section -->
      <div class="tab-content" *ngIf="activeTab === 'flights'">
        <!-- Search Section -->
        <section class="search-section">
          <div class="search-header">
            <h2>Rechercher un vol</h2>
            <button class="btn-reset" (click)="resetFilters()" *ngIf="hasActiveFilters()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                <path d="M3 3v5h5"/>
              </svg>
              Réinitialiser
            </button>
          </div>
          
          <div class="search-filters">
            <div class="filter-group">
              <label>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="11" cy="11" r="8"/>
                  <path d="m21 21-4.3-4.3"/>
                </svg>
                Départ
              </label>
              <input 
                type="text" 
                class="filter-input"
                [(ngModel)]="filters.depart"
                (ngModelChange)="applyFilters()"
                placeholder="Ville de départ">
            </div>
  
            <div class="filter-group">
              <label>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 22s-8-4.5-8-11.8A8 8 0 0 1 12 2a8 8 0 0 1 8 8.2c0 7.3-8 11.8-8 11.8z"/>
                  <circle cx="12" cy="10" r="3"/>
                </svg>
                Arrivée
              </label>
              <input 
                type="text" 
                class="filter-input"
                [(ngModel)]="filters.arrive"
                (ngModelChange)="applyFilters()"
                placeholder="Ville d'arrivée">
            </div>
  
            <div class="filter-group">
              <label>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect width="18" height="18" x="3" y="4" rx="2" ry="2"/>
                  <line x1="16" x2="16" y1="2" y2="6"/>
                  <line x1="8" x2="8" y1="2" y2="6"/>
                  <line x1="3" x2="21" y1="10" y2="10"/>
                </svg>
                Date
              </label>
              <input 
                type="date" 
                class="filter-input"
                [(ngModel)]="filters.date"
                (ngModelChange)="applyFilters()">
            </div>
  
            <div class="filter-group">
              <label>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"/>
                </svg>
                Compagnie
              </label>
              <input 
                type="text" 
                class="filter-input"
                [(ngModel)]="filters.compagnie"
                (ngModelChange)="applyFilters()"
                placeholder="Nom de la compagnie">
            </div>
  
            <div class="filter-group">
              <label>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" x2="12" y1="1" y2="23"/>
                  <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                </svg>
                Prix max
              </label>
              <input 
                type="number" 
                class="filter-input"
                [(ngModel)]="filters.prixMax"
                (ngModelChange)="applyFilters()"
                placeholder="Prix maximum">
            </div>
          </div>
  
          <!-- Active Filters Tags -->
          <div class="active-filters" *ngIf="hasActiveFilters()">
            <span class="filter-tag" *ngIf="filters.depart">
              Départ: {{filters.depart}}
              <button (click)="clearFilter('depart')">×</button>
            </span>
            <span class="filter-tag" *ngIf="filters.arrive">
              Arrivée: {{filters.arrive}}
              <button (click)="clearFilter('arrive')">×</button>
            </span>
            <span class="filter-tag" *ngIf="filters.date">
              Date: {{filters.date}}
              <button (click)="clearFilter('date')">×</button>
            </span>
            <span class="filter-tag" *ngIf="filters.compagnie">
              Compagnie: {{filters.compagnie}}
              <button (click)="clearFilter('compagnie')">×</button>
            </span>
            <span class="filter-tag" *ngIf="filters.prixMax">
              Prix max: {{filters.prixMax}} TND
              <button (click)="clearFilter('prixMax')">×</button>
            </span>
          </div>
        </section>
  
        <!-- Flights Grid -->
        <section class="flights-section">
          <div class="section-header">
            <h2>Vols disponibles</h2>
            <span class="flights-count">{{filteredVols.length}} vols trouvés</span>
          </div>
  
          <!-- No Results State -->
          <div class="no-results" *ngIf="filteredVols.length === 0">
            <div class="no-results-icon">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <circle cx="11" cy="11" r="8"/>
                <path d="m21 21-4.3-4.3"/>
                <path d="M8 8l6 6"/>
                <path d="M14 8l-6 6"/>
              </svg>
            </div>
            <h3>Aucun vol trouvé</h3>
            <p>Essayez de modifier vos critères de recherche</p>
            <button class="btn-reset-large" (click)="resetFilters()">Réinitialiser les filtres</button>
          </div>
  
          <div class="flights-grid">
            <div class="flight-card" *ngFor="let vol of filteredVols; let i = index" 
                 [style.animation-delay]="(i * 0.1) + 's'">
              
              <!-- Card Header -->
              <div class="card-header">
                <div class="airline-info">
                  <div class="airline-logo">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"/>
                    </svg>
                  </div>
                  <div>
                    <span class="airline-name">{{vol.compagnie}}</span>
                    <span class="plane-model">{{vol.avion}}</span>
                  </div>
                </div>
                <span class="duration-tag">{{vol.time}}</span>
              </div>
  
              <!-- Route Visualization -->
              <div class="route-visual">
                <div class="city-block departure">
                  <span class="city-code">{{vol.depart | slice:0:3 | uppercase}}</span>
                  <span class="city-name">{{vol.depart}}</span>
                  <span class="time">{{vol.timeDepart}}</span>
                </div>
                
                <div class="flight-path">
                  <div class="path-line">
                    <div class="plane-icon">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"/>
                      </svg>
                    </div>
                  </div>
                  <span class="path-date">{{vol.dateDepart}}</span>
                </div>
  
                <div class="city-block arrival">
                  <span class="city-code">{{vol.arrive | slice:0:3 | uppercase}}</span>
                  <span class="city-name">{{vol.arrive}}</span>
                  <span class="time">Arrivée</span>
                </div>
              </div>
  
              <!-- Card Footer -->
              <div class="card-footer">
                <div class="price-block">
                  <span class="price-label">À partir de</span>
                  <span class="price-value">{{vol.prix}} <small>TND</small></span>
                </div>
                <!-- Just shows toast, no form -->
                <button class="btn-reserve" type="button" (click)="quickReserve()">
                  <span>Réserver</span>
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M5 12h14"/>
                    <path d="m12 5 7 7-7 7"/>
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </section>
      </div>
  
      <!-- TAB 2: Custom Reservation Section (Real form) -->
      <div class="tab-content" *ngIf="activeTab === 'custom'">
        <section class="custom-reservation-section">
          <div class="custom-reservation-container">
            <!-- Left: Illustration -->
            <div class="custom-illustration">
              <div class="illustration-content">
                <div class="floating-plane-large">
                  <svg width="80" height="80" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"/>
                  </svg>
                </div>
                <h3>Créez votre voyage sur mesure</h3>
                <p>Entrez votre itinéraire personnalisé et nous nous occupons du reste.</p>
                
                <div class="feature-list">
                  <div class="feature-item">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                      <polyline points="22 4 12 14.01 9 11.01"/>
                    </svg>
                    <span>Destinations flexibles</span>
                  </div>
                  <div class="feature-item">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                      <polyline points="22 4 12 14.01 9 11.01"/>
                    </svg>
                    <span>Confirmation rapide</span>
                  </div>
                  <div class="feature-item">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                      <polyline points="22 4 12 14.01 9 11.01"/>
                    </svg>
                    <span>Support 24/7</span>
                  </div>
                </div>
              </div>
            </div>
  
            <!-- Right: Real Reservation Form -->
            <div class="custom-form-container">
              <div class="form-header">
                <h2>Réservation personnalisée</h2>
                <p>Remplissez les informations ci-dessous pour votre voyage.</p>
              </div>
  
              <form class="custom-reservation-form" (ngSubmit)="onSubmit()">
                <div class="form-section">
                  <h4>Itinéraire</h4>
                  <div class="form-row">
                    <div class="form-group">
                      <label for="fromLocal">De (Départ)</label>
                      <input type="text" id="fromLocal" class="form-control"
                        [(ngModel)]="reservation.fromLocal" name="fromLocal" placeholder="Ville de départ" required>
                    </div>
                    <div class="form-group">
                      <label for="toLocal">À (Arrivée)</label>
                      <input type="text" id="toLocal" class="form-control"
                        [(ngModel)]="reservation.toLocal" name="toLocal" placeholder="Ville d'arrivée" required>
                    </div>
                  </div>
                </div>
  
                <div class="form-section">
                  <h4>Informations passager</h4>
                  <div class="form-row">
                    <div class="form-group">
                      <label for="nom">Nom</label>
                      <input type="text" id="nom" class="form-control"
                        [(ngModel)]="reservation.nom" name="nom" placeholder="Votre nom" required>
                    </div>
                    <div class="form-group">
                      <label for="prenom">Prénom</label>
                      <input type="text" id="prenom" class="form-control"
                        [(ngModel)]="reservation.prenom" name="prenom" placeholder="Votre prénom" required>
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="form-group">
                      <label for="email">Email</label>
                      <input type="email" id="email" class="form-control"
                        [(ngModel)]="reservation.email" name="email" placeholder="votre@email.com" required>
                    </div>
                    <div class="form-group">
                      <label for="telephone">Téléphone</label>
                      <input type="number" id="telephone" class="form-control"
                        [(ngModel)]="reservation.telephone" name="telephone" placeholder="+216 XX XXX XXX" required>
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="form-group">
                      <label for="nombreVoyageur">Nombre de voyageurs</label>
                      <input type="number" id="nombreVoyageur" class="form-control"
                        [(ngModel)]="reservation.nombreVoyageur" name="nombreVoyageur" placeholder="1" min="1" required>
                    </div>
                    <div class="form-group">
                      <label for="postalCode">Code postal</label>
                      <input type="number" id="postalCode" class="form-control"
                        [(ngModel)]="reservation.postalCode" name="postalCode" placeholder="1000" required>
                    </div>
                  </div>
                  <div class="form-group full-width">
                    <label for="adresse">Adresse</label>
                    <input type="text" id="adresse" class="form-control"
                      [(ngModel)]="reservation.adresse" name="adresse" placeholder="Votre adresse complète" required>
                  </div>
                </div>
  
                <button class="btn-custom-submit" type="submit">
                  <span>Confirmer la réservation</span>
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                    <polyline points="22 4 12 14.01 9 11.01"/>
                  </svg>
                </button>
              </form>
            </div>
          </div>
        </section>
      </div>
    </div>
  </main>